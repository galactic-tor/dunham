apiVersion: batch/v1
kind: CronJob
metadata:
  name: dunham-cron
spec:
  schedule: "*/10 * * * *"
  successfulJobsHistoryLimit: 5
  failedJobsHistoryLimit: 5
  jobTemplate:
    spec:
      template:
        metadata:
          labels: 
            name: dunham-cron
        spec:
          containers:
            - name: dunham
              image: docker.io/kwyn/dunham:latest
              imagePullPolicy: IfNotPresent
              volumeMounts:
              - name: dunham-dot-env
                mountPath: "/home/pptruser/workspace/secrets/"
                readOnly: true
              - name: nov-5th-config
                mountPath: "/home/pptruser/workspace/configmaps/"
          restartPolicy: Never
          volumes:
          - name: dunham-dot-env
            secret:
              secretName: dunham.env
          - name: nov-5th-config
            configMap:
              name: nov-5th-config
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels: 
    name: dunham-cron
  name: nov-5th-config 
data:
  sites.json: |
    [
      "Upper Pines",
      "Lower Pines",
      "North Pines"
    ]
  dates.json: |
    {
      "start": "11/07/2022",
      "end": "11/06/2022"
    }
